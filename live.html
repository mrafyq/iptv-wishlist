<html lang="en">
    <head>
        <link rel="stylesheet" href="live.css">
        <title>IPTV Favoris</title>
        <meta charset="UTF-8">
    </head>
    <body>
        <div class="sidebar" id="sidebar">
            <ul class="list-tabs">
                <li class="tab tab-bouquet selected" data-list="list-bouquet">Bouquet</li>
                <li class="tab tab-favoris" data-list="list-favoris">Favoris</li>
            </ul>
            <ul class="list-bouquet" id="sidebar-bouquet__list"></ul>
            <ul class="list-favoris" id="sidebar-favoris__list"></ul>
            <div id="wishlist-buttons" class="wishlist-buttons" style="display: none">
                <div class="action-rename"><div class="dot green"> </div>Renommer</div>
                <div class="action-delete"><div class="dot red"> </div>Supprimer</div>
                <div class="action-pin"><div class="dot yellow"> </div>Pin</div>
            </div>
        </div>
        
        <div class="screen">
            <div class="left">
            <div class="left-up">
            <div class="group-name">Group Name</div>
                <div>search <input type="text" placeholder="Search..." title="Search..."><i class="fa fa-search"></i></div>
            </div>
                <ul id="list-channels" class="list-channels"><!-- attribute data-attr-back-list added for manage arrowLeft key-->
                </ul>
            </div>
            <div class="right">
                <div class="date"> 19:54 | Fri Jun 23 2023</div>
                <div class="player"></div>
                <div class="epg">
                    <div>
                        7:50 PM - 8:00 PM C'est Canteloup
                    </div>
                    <div>
                        <progress value="46" max="100"></progress>
                    </div>
                    <ul>
                        <li>8:10 PM	Koh-Lanta, le totem maudi</li>
                        <li>10:30 PM	Et alors ?</li>
                        <li>12:00 PM	C'est Canteloup</li>
                        <li>13:10 PM	Koh-Lanta, le totem maudit</li>
                    </ul>
                </div>
                <div class="buttons">
                    <div><div class="dot green"> </div>EPG guide</div>
                    <div class="add-to-favoris"><div class="dot red"> </div>Favoris</div>
                    <div><div class="dot yellow"> </div>Control parental</div>
                    <div><div class="dot blue"> </div>trier</div>
                </div>
            </div>
        </div>
        <!-- Popup -->
        <div class="popup popup-rename">
            <div class="popup-inner">
                <div class="popup-title">Modifier le nom de favoris</div>
                <input type="text" id="rename" name="rename" placeholder="Nom de favoris souhaitÃ© ... ">
                <div>
                    <button type="button" class="action-rename-save">Enregistrer</button>
                    <button type="button" class="action-cancel">Annuler</button>
                </div>
            </div>
        </div>
        <script  type="text/javascript">
            const favButton = document.querySelector('.add-to-favoris');
            const popupFav = document.querySelector('.sidebar-favoris');
            var listFav = document.getElementById('sidebar-favoris__list');
            var listBouquet = document.getElementById('sidebar-bouquet__list');
            var listChannels0 = document.getElementById('list-channels');
            fetch('data/db.json')
                .then(res => res.json())
                .then(data =>
                    {
                        (data.favoris).forEach((element, index) => {
                            const li = document.createElement('li');
                            li.setAttribute('id', element.favori_id);
                            li.setAttribute('class', 'favoris');
                            li.innerHTML = element.favori_name;
                            listFav.appendChild(li);
                        });
                        (data.bouquets).forEach((element, index) => {
                            const li = document.createElement('li');
                            li.setAttribute('id', element.bouquet_id);
                            li.setAttribute('class', 'bouquet');
                            li.innerHTML = element.bouquet_name;
                            listBouquet.appendChild(li);
                        });
                        (data.channels).forEach((element, index) => {
                            const li = document.createElement('li');
                            li.setAttribute('data-attr-id', element.channel_id);
                            li.setAttribute('data-attr-name', element.channel_name);
                            if (index == 0) {
                                li.setAttribute('class', 'channel selected');
                            } else {
                                li.setAttribute('class', 'channel');
                            }
                            li.innerHTML = element.channel_name;
                            listChannels0.appendChild(li);
                        });
                    }
                )
                .catch(err => console.log(err));

            favButton.addEventListener('click', () => {
                const listChanSelected = document.querySelector('#list-channels .channel.selected');
                const listChanSelectedID = listChanSelected.getAttribute('data-attr-id');
                const listChanSelectedName = listChanSelected.getAttribute('data-attr-name');
                console.log('The ID is ' + listChanSelectedID + ' And the Name is ' + listChanSelectedName);
                fetch('data/db.json')
                    .then(res => res.json())
                    .then(data => {
                        data.favoris.push({
                            "favori_id": parseInt(listChanSelectedID),
                            "favori_name": listChanSelectedName
                        });
                        console.log(data);
                    })
                    .catch(err => console.log(err));
            })

        </script>
        <script type="text/javascript" src="live.js"></script>

    </body>
</html>